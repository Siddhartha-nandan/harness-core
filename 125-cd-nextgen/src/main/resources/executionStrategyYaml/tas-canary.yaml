failureStrategies:
  - onFailure:
      errors:
        - AllErrors
      action:
        type: StageRollback
spec:
  execution:
    steps:
      - step:
          name: "Canary Setup Step"
          identifier: canarySetupStep
          type: CanaryAppSetup
          timeout: 10m
          spec:
            instanceCount: FromManifest
            resizeStrategy: DownScaleOldFirst
            existingVersionToKepp: 3
            additionalRoutes: ""
      - step:
          name: "Deploy Step"
          identifier: deployStep
          type: AppResize
          timeout: 10m
          spec:
            newAppInstances:
              type: Percentage
              value: 100
            oldAppInstances:
              type: Count
              value: 0
    rollbackSteps:
      - step:
          name: "App Rollback"
          identifier: appRollback
          type: AppRollback
          timeout: 10m
          spec: {}